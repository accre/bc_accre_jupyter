# Batch Connect app configuration file
#
# @note Used to define the submitted cluster, title, description, and
#   hard-coded/user-defined attributes that make up this Batch Connect app.
---

# **MUST** set cluster id here that matches cluster configuration file located
# under /etc/ood/config/clusters.d/*.yml
# @example Use the Owens cluster at Ohio Supercomputer Center
#     cluster: "owens"
cluster: "accre"

# Define attribute values that aren't meant to be modified by the user within
# the Dashboard form
attributes:
  # Set the corresponding modules that need to be loaded for Jupyter to run
  #
  # @note It is called within the batch job as `module load <modules>` if
  #   defined
  # @example Do not load any modules
  #     modules: ""
  # @example Using default python module
  #     modules: "python"
  # @example Using specific python module
  #     modules: "python/3.5"
  # @example Using combination of modules
  #     modules: "python/3.5 cuda/8.0.44"
  modules: "Anaconda3"

  # Any extra command line arguments to feed to the `jupyter notebook ...`
  # command that launches the Jupyter notebook within the batch job
  extra_jupyter_args: ""
  bc_account: null
  bc_queue: null
  bc_num_slots: null
  bc_num_hours:
    value: 48
  bc_mem:
    label: "Maximum Memory (GB)"
    value: 4
  bc_num_cores:
    label: "Number of CPU Cores"
    value: 1
  notebook_dir:
    label: "Working Directory" 
    help: "Directory containing your notebook files. Defaults to your home directory, you must include the absolute path to the directory."
    widget: "text_field"
    value: "${HOME}"
  version:
    widget: select
    label: "Python, R, and Anaconda or GCC version"
    help: "This defines the version of Python, R and distribution or toolchain that you want to load."
    options:
      # Define functioning R version overloads using a colon after the module load statement
      - [ "Python 3.6.3 / Anaconda 5.0.1", "Anaconda3/5.0.1"]
      - [ "Python 3.6.1 / Anaconda 4.4.0", "Anaconda3/4.4.0"]
      - [ "Python 2.7.14 / Anaconda 5.0.1", "Anaconda2/5.0.1"]
      - [ "Python 2.7.13 / Anaconda 4.4.0", "Anaconda2/4.4.0"]
      - [ "Python 2.7.14 / R 3.4.3 / GCC/6.4.0-2.28", "GCC/6.4.0-2.28/Python2"]
      - [ "Python 3.6.3 / GCC/6.4.0-2.28", "GCC/6.4.0-2.28/Python3"]
  use_venv:
    widget: check_box
    checked_value: 1
    unchecked_value: 0
    label: "Use a Conda Virtual Environment"
    help: |
      Check this box if you wish to load a conda virtual environment. Note that
      you must install jupyter into your virtual environment in order for
      your packages to be available. If installed, the version of python in your
      conda environment will override the default version selected above.
      Note that python virtual environments using the venv or virtualenv packages
      are not yet supported but are planned for the near future.
  venv:
    widget: "text_field"
    label: "Conda Virtual Environment"
    help: "Leave blank unless using a conda virtual environment"
    value: ""
  cgw:
    label: "Custom Gateway Node"
    value: "N/A"
    help: "Leave blank unless using a custom gateway node"
  use_cgw:
    widget: check_box
    checked_value: 1
    unchecked_value: 0
    label: "Use a Custom Gateway Node"
    help: |
      Check this box if you wish to run your job on a custom gateway
      node instead of a standard compute node. You must be a member of
      a group that has an OnDemand enabled custom gateway to use this
      feature. If you wish to have OnDemand enabled on your group's
      custom gateway, please open a helpdesk ticket. If this box is
      checked, then you must enter the name of your custom gateway
      above. 

# All of the attributes that make up the Dashboard form (in respective order),
# and made available to the submit configuration file and the template ERB
# files
#
# @note You typically do not need to modify this unless you want to add a new
#   configurable value
# @note If an attribute listed below is hard-coded above in the `attributes`
#   option, then it will not appear in the form page that the user sees in the
#   Dashboard
form:
  - modules
  - extra_jupyter_args
  - bc_account
  - bc_queue
  - bc_num_hours
  - bc_mem
  - bc_num_cores
  - bc_num_slots
  - notebook_dir
  - version
  - venv
  - use_venv
  - cgw
  - use_cgw
